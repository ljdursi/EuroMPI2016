Running head: SNP IDENTIFICATION FROM SHORT READ SEQUENCES Title: SISRS: SNP Identification from Short Read Sequences Authors: Rachel S. Schwartz1,*, Kelly Harkins2, Anne C. Stone2, Reed A. Cartwright1,3
1 2

Center for Evolutionary Medicine and Informatics, The Biodesign Institute School of Human Evolution & Social Change 3 School of Life Sciences Arizona State University; Tempe, AZ, USA *To whom correspondence should be addressed

1

ABSTRACT Motivation: One of the important challenges in modern phylogenetics is to identify data that can be used to resolve species relationships accurately. Whole-genome shotgun sequencing provides large amounts of data from which to identify phylogenetically informative sites; however, previous studies have required genome assembly or alignment to a reference genome, which is difficult when species are not closely related.

Results: We have developed a pipeline to extract potentially informative sites directly from raw short-read sequence data. Reads are assembled into conserved genome fragments, reads are then aligned to these fragments, and informative sites are identified. This pipeline produced >14000 informative sites from reads for 12 species of Leishmania and a reference genome. When analyzed using standard phylogenetic methods, these data resulted in a fully bifurcating tree with strongly supported nodes.

Availability and Implementation: Our procedure is implemented in the software SISRS (pronounced "scissors") which is freely available at https://github.com/rachelss/SISRS.

Contact: Rachel.Schwartz@asu.edu

Supplementary information: None.

2

INTRODUCTION The goal of the field of phylogenetics is to resolve relationships among taxa. Current approaches for accomplishing this goal often use DNA sequence data, with the expectation that more data will provide better phylogenetic resolution, and whole-genome data will allow us to determine previously unresolved relationships (Delsuc, et al., 2005). However, analyzing genome-scale data can be computationally prohibitive, and even genomic data will not circumvent the difficulties of identifying informative, homologous characters (Delsuc, et al., 2005; Mccormack, et al., 2013). The difficulty lies in finding loci that are variable among species, but have phylogenetic signal that is not overwhelmed by homoplasy or differential lineage sorting (Philippe, et al., 2011). Until recently, many studies used particular loci that had previously been identified as phylogenetically informative (e.g. rRNAs, mtDNA genes), often because their structure and/or substitution rates were known (Hillis, et al., 1996; Simon, et al., 2006). Prior knowledge of these loci made it possible to sequence variable, homologous data across a variety of taxa (e.g. Maggioni, et al., 2001; Rouland-Lefevre, et al., 2002). A recent improvement on this approach has been to use genome sequencing to identify large numbers of loci that are variable within species or clades (e.g. O'Neill, et al., 2013; Senn, et al., 2013; Steele, et al., 2008). These loci can be amplified and sequenced using standard methods. A drawback of these approaches is that new phylogenetic markers must be identified for each research study. Sequencing whole genomes has been suggested as a way to circumvent this discovery process, but the approaches taken to-date have required aligning data to a reference genome to extract informative loci (e.g. Yoder, et al., 2013). Thus, such methods have primarily focused on closely related species for which alignments are possible (e.g. Yoder, et al., 2013).

3

We propose a new method to rapidly provide informative markers for taxa of interest from genomic data, without a priori knowledge of which markers might be useful for phylogenetic reconstructions. Our approach assembles data from all species of interest into short contigs representing conserved regions of the genome. Similar to "alignment-free" approaches (e.g. Jun, et al., 2009; Sims, et al., 2009), our approach circumvents the difficulties in identifying homologous sites from whole-genome alignments when rearrangement events have occurred because the conserved regions are not required to share synteny across taxa. We then identify sites that are variable across taxa, but fixed within taxa. Variation among reads can be caused by (1) heterozygosity, (2) sequencing error, or (3) copy number variable regions aligning together. Avoiding erroneous alignments and paralogous data can significantly reduce non-phylogenetic signal (Philippe, et al., 2011). In this way, we identify parts of the genome that are of an ideal evolutionary rate to be phylogenetically informative. When a reference genome is available, the contigs can be mapped to the reference. Mapping the contigs makes it possible to (1) identify genes and/or functionality of the sites used in phylogenetic reconstruction, and (2) to identify linkage for SNPs that are not close enough to appear within a single contig. The use of strongly linked sites in phylogenetics is standard practice; however if the sites are treated as separate loci, as in the coalescent method implemented in SNAPP (Bryant, et al., 2012), using linked SNPs may bias the estimate of the species tree toward the estimate of the gene tree for these SNPs. Thus, we make it possible to identify linked SNPs in order to remove bias.

4

METHOD SISRS is a simple command-line program program for use on UNIX/LINUX systems consisting of the shell script sisrs, and two python scripts. Installation of the following software is required to run SISRS: the de novo assembly program Velvet (Zerbino and Birney, 2008), the short read aligner Bowtie2 (Langmead and Salzberg, 2012), Python 2.7, and Perl. An example command to run SISRS is as follows: ./sisrs -r ./reference.fasta -p 40 -f fastq -m 4 -a ./fastq_data/. The flags to modify the functionality of SISRS are described in Table 1.

Data requirements Reads are assumed to be paired and in either FASTA or FASTQ format, with pairs identified by filenames containing R1 and R2 respectively. Paired-end reads are the current standard for the Illumina platform; they provide information about the relative location of the reads to one another, thus improving assembly. Multiple read files are allowed per taxon; all reads in one folder will be considered as coming from one taxon. The reference genome should be in FASTA format. Extensions to all file names should be spelled out (i.e. fasta, not fa).

Workflow The workflow for the informatic pipeline implemented in SISRS is diagrammed in Figure 1 and explained below: (1) Assembly into reference genome fragments We provide a wrapper for the de novo assembly program Velvet (Zerbino and Birney, 2008) to produce fragments of what can be considered a combined reference genome. Velvet provides the option to include a reference genome (as a long sequence) and to provide some

5

information about the mapping of data to this reference. The reference genome can be provided to SISRS using the `r' flag. In this initial release of SISRS we assign a default k-mer length of 21 to be used in Velvet. This value can be adjusted using the `k' flag. Different k-mer lengths may provide different sets of reference contigs.

(2) Align reads to reference contigs Reads for each taxon are aligned to the reference contigs produced in step 1 using the short read aligner Bowtie2 (Langmead and Salzberg, 2012). Results are output in the standard BAM format.

(3) Map contigs to the reference genome Contigs are aligned to the reference genome in order to identify their location and relative proximity. Aligning contigs allows us to identify the location of each SNP used to construct the phylogeny. This step is skipped if no reference genome is provided.

(4) Identify informative sites for each species To ensure that each site for each species is determined accurately, a minimum number of sequencing reads can be set using the `-n' flag. This process ensures sufficient coverage at each site to suggest the correct allele. Default coverage is set to three reads. Additionally, the base at a site is only called if there is no variation among reads. We remove all sites that are invariant among taxa. We allow the user to select the number of taxa for which information can be missing at a site in the final alignment using the `-m' flag. Final results are output as NEXUS files including alignments of (1) all SNPs and (2) biallelic

6

SNPs (required for some analyses). Each site is identified by its position in the reference genome (if provided) or by the position in each contig. It is possible to repeat the latter part of step 4 without running the whole program by using the `-s' flag. Running this step in isolation allows the rapid identification of datasets with different amounts of missing data. A flowchart for how SISRS can be used to obtain optimal data is shown in Figure 2.

RESULTS AND DISCUSSION We use our approach to identify phylogenetically informative markers for 13 species of Leishmania, a genus of protozoan parasite that causes the human leishmaniasis disease complex. Our data consisted of whole-genome short-read sequences for 12 species and one assembled reference genome. Despite advancements in molecular techniques and the availability of sequence data, the origin of Leishmania, and the relationships of species within the genus, are the sources of ongoing debate (Tuon, et al., 2008). Previous research has resulted in incomplete and conflicting phylogenies (e.g. Asato, et al., 2009; Croan, et al., 1997; Dougall, et al., 2011; Fraga, et al., 2010; Lainson, 1997; Lainson and Shaw, 1987; Noyes, et al., 2002; Zelazny, et al., 2005). It is thus of interest to evaluate whether whole gnome data can resolve such phylogenetic conflict.

Raw data Leishmania DNA was extracted from multiple promastigotes (the flagellate stage of Leishmania) per species due to an inability to isolate individual promastigotes during DNA extraction. Sequencing was performed by the University of Arizona Genome Core using an Illumina HiSeq 2000. Read size ranged from 20-100bp. The number of pairs of reads for each

7

species ranged from 2.1-14.3 million with a total of over 175 million sequences. Reads from only five of the 12 species could be aligned to a reference genome, making it difficult to extract informative loci from these data directly.

Output data Velvet produced over 5.2 million contigs. These contigs represent genome fragments that are conserved across species regardless of their position in the genome. If the entire genome was highly conserved across species with perfect synteny, we would expect a reference genome consisting of a number of contigs equal to the number of chromosomes. For all species, over 80% of the raw data was aligned to the reference contig fragments (in most cases 90+% aligned). However, up to 90% of the pairs did not align concordantly and up to 75% aligned to more than one fragment. However, this result is not surprising because the reference contigs are short, so that pairs that are not fully overlapping may align poorly to the same contig, and may align more than once. The former situation is not relevant for our analyses, while the latter situation is handled later in the process by limiting the processed data to sites that are fixed for a species. 25% of the reference contigs were mapped to the reference genome L.V. braziliensis. When allowing for one taxon to have missing data at a given site, we identified 14106 SNPs; of these, 12352 are biallelic and 98% mapped to the reference genome.

Simple preliminary phylogenetic analysis For this preliminary analysis, we treated the processed data as a single concatenated locus (e.g. Yoder, et al., 2013). We analyzed the data with Bayesian and maximum likelihood (ML) analyses using CIPRES (Miller, et al., 2010). The Bayesian analysis was carried out using

8

MrBayes 3.1.2 (Huelsenbeck and Ronquist, 2001; Ronquist and Huelsenbeck, 2003) with a GTR model and substitution rates following a discrete gamma distribution with four categories. We used two runs with four chains and one million generations. Convergence was checked with AWTY (Nylander, et al., 2008). The burnin was set to 30%. Trees were rooted using Endotrypanum. The resulting tree was fully bifurcating with posterior probability of 1.0 for all nodes (Figure 3). The ML analysis was carried out with identical parameters for 100 bootstrap replicates using RAxML 7.2.8 (Stamatakis, 2006). The topology of the ML bootstrap phylogeny was identical to the phylogeny produced with the Bayesian analysis, and all nodes had 100% support. These strongly supported results suggest the value of the data produced with our method. As expected, our results place species of Old and New World subgenus Leishmania (L. aeithiopica, L. tropica, and L. pifanoi), which are characterized by development in the midgut and foregut of their sandfly host, in a monophyletic clade separate from species of the exclusively New World subgenus Viannia (L.V. guyanensis, L.shawii, L.V. panamensis, L.V. braziliensis, L.V.naiffi, and L.V. lainsoni), which undergo an additional developmental phase in the hindgut (Cupolillo, et al., 2000). Interestingly, our results place L. enrietti, a parasite of the Brazilian guinea pig, sister to the L. Leishmania. This result is consistent with early hypotheses that L. enriettii is a member of the New World L. Leishmania subgenus (Lainson, 1997; Lainson and Shaw, 1987), rather than ancestral to both subgenera, as determined later using molecular markers (Croan, et al., 1997; Noyes, et al., 2002; Noyes, et al., 2000; Stevens, et al., 2001).

9

FUTURE DIRECTIONS SISRS is under active development. Future versions of SISRS will output more SNPs as a result of improved contig assembly and the addition of other data types. First, we will optimize the process of producing reference contigs, by (1) allowing the k-mer length in Velvet to be varied automatically to produce optimal results, and (2) using alternative assembly methods such as SOAPdenovo2 (Luo, et al., 2012) and Ray (Boisvert, et al., 2012). We will add the ability to use unpaired reads, as well as multiple whole and partial reference genomes to construct contigs. We will also incorporate a probabilistic model for determining fixed sites (i.e. allow for limited error and incorporate quality scores for each read). Datasets including a range of missing data will be output automatically. Future versions will also output additional information, including taxon-diagnostic SNPs when multiple individuals are available per taxon.

FUNDING This work was supported by ASU startup funds to RAC and a National Science Foundation Doctoral Dissertation Improvement Grant [grant number BCS-1232582 to KH and ACS].

ACKNOWLEDGEMENTS Members of the Cartwright lab provided feedback on this project and manuscript. DNA from L. shawii, L. naiffi, and L. lainsoni was provided by Dr. Lucille Floeter-Winter (University of So Paulo); promastigote isolates (L. aethiopica LRC-L147, L. hertigi M4051, L.panamensis WR120, L. guyanensis M4147, L.tropica LRC-L39, Endotrypanum M6159, L. deanei S295. L.pifanoi, and L. enriettii) were provided by Dr. Diane McMahon-Pratt (Yale University). The

10

assembled reference genome of L. braziliensis was downloaded from the Wellcome Trust Sanger Institute ftp site.

11

REFERENCES Asato, Y., Oshiro, M., Myint, C.K., Yamamoto, Y., Kato, H., Marco, J.D., Mimori, T., Gomez, E.A., Hashiguchi, Y. and Uezato, H. (2009) Phylogenic analysis of the genus Leishmania by cytochrome b gene sequencing, Exp Parasitol, 121, 352-361. Boisvert, S., Raymond, F., Godzaridis, ., Laviolette, F. and Corbeil, J. (2012) Ray Meta: scalable de novo metagenome assembly and profiling, Genome Biol, 13, R122. Bryant, D., Bouckaert, R., Felsenstein, J., Rosenberg, N.A. and RoyChoudhury, A. (2012) Inferring species trees directly from biallelic genetic markers: bypassing gene trees in a full coalescent analysis, Mol Biol Evol, 29, 1917-1932. Croan, D.G., Morrison, D.A. and Ellis, J.T. (1997) Evolution of the genus Leishmania revealed by comparison of DNA and RNA polymerase gene sequences, Mol Biochem Parasitol, 89, 149159. Cupolillo, E., Medina-Acosta, E., Noyes, H., Momen, H. and Grimaldi, G., Jr. (2000) A revised classification for Leishmania and Endotrypanum, Parasitol Today, 16, 142-144. Delsuc, F., Brinkmann, H. and Philippe, H. (2005) Phylogenomics and the reconstruction of the tree of life, Nat Rev Gen, 6, 361-375. Dougall, A.M., Alexander, B., Holt, D.C., Harris, T., Sultan, A.H., Bates, P.A., Rose, K. and Walton, S.F. (2011) Evidence incriminating midges (Diptera: Ceratopogonidae) as potential vectors of Leishmania in Australia, Int J Parasitol, 41, 571-579.

12

Fraga, J., Montalvo, A.M., De Doncker, S., Dujardin, J.C. and Van der Auwera, G. (2010) Phylogeny of Leishmania species based on the heat-shock protein 70 gene, Infect Genet Evol, 10, 238-245. Hillis, D.M., Moritz, C. and Mable, B.K. (eds) (1996) Molecular Systematics. Sinauer. Huelsenbeck, J. and Ronquist, F. (2001) MRBAYES: Bayesian inference of phylogenetic trees, Bioinformatics, 17, 754-755. Jun, S.R., Sims, G.E., Wu, G.A. and Kim, S.H. (2009) Whole-proteome phylogeny of prokaryotes by feature frequency profiles: an alignment-free method with optimal feature resolution, Proc Natl Acad Sci U S A, 107, 133-138. Lainson, R. (1997) On Leishmania enriettii and other enigmatic Leishmania species of the Neotropics, Mem Inst Oswaldo Cruz, 92, 377-387. Lainson, R. and Shaw, J.J. (1987) Evolution, classification, and geographical distribution. In Peters, W. and Killick-Kendrick, R. (eds), The leishmaniases in biology and medicine. Academic Press, London, 1-120. Langmead, B. and Salzberg, S.L. (2012) Fast gapped-read alignment with Bowtie 2, Nat Methods, 9, 357-359. Luo, R., Liu, B., Xie, Y., Li, Z., Huang, W., Yuan, J., He, G., Chen, Y., Pan, Q., Liu, Y., Tang, J., Wu, G., Zhang, H., Shi, Y., Liu, Y., Yu, C., Wang, B., Lu, Y., Han, C., Cheung, D.W., Yiu, S.-M., Peng, S., Xiaoqian, Z., Liu, G., Liao, X., Li, Y., Yang, H., Wang, J., Lam, T.-W. and

13

Wang, J. (2012) SOAPdenovo2: an empirically improved memory-efficient short-read de novo assembler, GigaScience, 1, 18. Maggioni, R., Rogers, A.D., Maclean, N. and D'Incao, F. (2001) Molecular phylogeny of western Atlantic Farfantepenaeus and Litopenaeus shrimp based on mitochondrial 16S partial sequences, Mol Phylogenet Evol, 18, 66-73. Mccormack, J.E., Hird, S.M., Zellmer, A.J., Carstens, B.C. and Brumfield, R.T. (2013) Applications of next-generation sequencing to phylogeography and phylogenetics, Mol Phylogenet Evol, 66, 526-538. Miller, M.A., Pfeiffer, W. and Schwartz, T. (2010) Creating the CIPRES Science Gateway for inference of large phylogenetic trees. Proceedings of the Gateway Computing Environments Workshop (GCE). New Orleans, LA, 1 - 8. Noyes, H., Pratlong, F., Chance, M., Ellis, J., Lanotte, G. and Dedet, J.P. (2002) A previously unclassified trypanosomatid responsible for human cutaneous lesions in Martinique (French West Indies) is the most divergent member of the genus Leishmania ss, Parasitology, 124, 1724. Noyes, H.A., Morrison, D.A., Chance, M.L. and Ellis, J.T. (2000) Evidence for a neotropical origin of Leishmania, Mem Inst Oswaldo Cruz, 95, 575-578. Nylander, J.A.A., Wilgenbusch, J.C., Warren, D.L. and Swofford, D.L. (2008) AWTY (are we there yet?): a system for graphical exploration of MCMC convergence in Bayesian phylogenetics, Bioinformatics, 24, 581-583.

14

O'Neill, E.M., Schwartz, R., Bullock, C.T., Williams, J.S., Shaffer, H.B., Aguilar-Miguel, X., Parra-Olea, G. and Weisrock, D.W. (2013) Parallel tagged amplicon sequencing reveals major lineages and phylogenetic structure in the North American tiger salamander (Ambystoma tigrinum) species complex, Mol Ecol, 22, 111-129. Philippe, H., Brinkmann, H., Lavrov, D.V., Littlewood, D.T., Manuel, M., Worheide, G. and Baurain, D. (2011) Resolving difficult phylogenetic questions: why more sequences are not enough, PLoS Biol, 9, e1000602. Ronquist, F. and Huelsenbeck, J. (2003) MrBayes 3: Bayesian phylogenetic inference under mixed models, Bioinformatics. Rouland-Lefevre, C., Diouf, M.N., Brauman, A. and Neyra, M. (2002) Phylogenetic Relationships in Termitomyces (Family Agaricaceae) based on the nucleotide sequence of ITS: a first approach to elucidate the evolutionary history of the symbiosis between fungus-growing termites and their fungi, Mol Phylogenet Evol, 22, 423-429. Senn, H., Ogden, R., Cezard, T., Gharbi, K., Iqbal, Z., Johnson, E., Kamps-Hughes, N., Rosell, F. and Mcewing, R. (2013) Reference-free SNP discovery for the Eurasian beaver from restriction site-associated DNA paired-end data, Mol Ecol, Early View. Simon, C., Buckley, T.R., Frati, F., Stewart, J.B. and Beckenbach, A.T. (2006) Incorporating molecular evolution into phylogenetic analysis, and a new compilation of conserved polymerase chain reaction primers for animal mitochondrial DNA, Ann Rev Ecol Evol Sys, 37, 545-579.

15

Sims, G.E., Jun, S.R., Wu, G.A. and Kim, S.H. (2009) Alignment-free genome comparison with feature frequency profiles (FFP) and optimal resolutions, Proc Natl Acad Sci U S A, 106, 26772682. Stamatakis, A. (2006) RAxML-VI-HPC: maximum likelihood-based phylogenetic analyses with thousands of taxa and mixed models, Bioinformatics, 22, 2688-2690. Steele, P.R., Guisinger-Bellian, M., Linder, C.R. and Jansen, R.K. (2008) Phylogenetic utility of 141 low-copy nuclear regions in taxa at different taxonomic levels in two distantly related families of rosids, Mol Phylogenet Evol, 48, 1013-1026. Stevens, J.R., Noyes, H.A., Schofield, C.J. and Gibson, W. (2001) The molecular evolution of Trypanosomatidae, Adv Parasitol, 48, 1-56. Tuon, F.F., Neto, V.A. and Amato, V.S. (2008) Leishmania: origin, evolution and future since the Precambrian, FEMS Immunol Med Microbiol, 54, 158-166. Yoder, J.B., Briskine, R., Mudge, J., Farmer, A., Paape, T., Steele, K., Weiblen, G.D., Bharti, A.K., Zhou, P., May, G.D., Young, N.D. and Tiffin, P. (2013) Phylogenetic signal variation in the genomes of Medicago (Fabaceae), Syst Biol, Early View. Zelazny, A.M., Fedorko, D.P., Li, L., Neva, F.A. and Fischer, S.H. (2005) Evaluation of 7SL RNA gene sequences for the identification of Leishmania spp, Am J Trop Med Hyg, 72, 415-420. Zerbino, D.R. and Birney, E. (2008) Velvet: algorithms for de novo short read assembly using de Bruijn graphs, Genome Res, 18, 821-829.

16

TABLES Table 1. Flags to adjust functionality in SISRS. Flag -r -k -p -f -m -a -n -s -h Optional Description Yes Yes Yes Yes Yes Yes Yes Yes Yes A file containing an assembled reference genome in FASTA format. K-mer size to be used by Velvet in contig assembly. Default = 21. Number of processors that can be used by SISRS as needed. Default = 1. The type of sequence data provided: FASTA or FASTQ. Default is FASTQ. Number of species allowed to lack in the final alignment (does not include the reference data). Default = (total number of species)-2. Folder containing subfolders containing reads for each taxon of interest. Default is current folder. Number of reads required for a taxon to call a site as a particular base. Default = 3. Will skip all steps except the one identifying whether sites are variable among taxa. Use this flag to change the amount of missing data allowed using previously identified contigs. Prints program information and help.

17

18

19

20

FIGURE CAPTIONS Figure 1. A flowchart outlining the informatic pipeline implemented in SISRS. Optional steps are indicated by dashed lines.

Figure 2. A flowchart outlining how SISRS can be implemented by the end-user. Optional steps are indicated by dashed lines.

Figure 3. Phylogeny of 13 Leishmania species produced using a Bayesian analysis of SNPs identified by SISRS and visualized in FigTree. Node labels indicate the posterior probability of the node. Maximum likelihood bootstrap values for all nodes were 100%.

21

